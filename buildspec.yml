version: 0.2

phases: 
    install:
        runtime-versions:
            nodejs: 22
        commands:
            - echo "installing something"
            - npm install -g yarn
            - yarn install
    pre_build:
        commands: 
            - echo "we are in the pre build phase"
    build:
        commands:
            - echo "Building the Next.js app..."
            - yarn build
            - echo "Copying build files to artifact directory..."
            - mkdir -p artifact
            - cp -r .next/static artifact/
            - cp -r public artifact/
            - cp package.json artifact/
            - if [ -d ".next/standalone" ]; then cp -r .next/standalone/* artifact/; fi
    post_build:
        commands:
            - echo "we are in the post build phase"

artifacts:
    files:
        - '**/*'
    base-directory: artifact
    discard-paths: no